# heldKarpAlgorithm

- _heldKarpAlgorithm(m)_

Implements the Held–Karp algorithm, also called the Bellman–Held–Karp algorithm.
The input is a distance matrix,
the answer is the minimum-length traversal,
along with the distance of the traversal.

A 4×4 distance matrix:

```
>>> [
>>> 	00 02 09 10;
>>> 	01 00 06 04;
>>> 	15 07 00 08;
>>> 	06 03 12 00
>>> ].heldKarpAlgorithm
(21, [1 3 4 2 1])
```

A 4×4 distance matrix:

```
>>> [
>>> 	00 10 15 20;
>>> 	10 00 35 25;
>>> 	15 35 00 30;
>>> 	20 25 30 00
>>> ].heldKarpAlgorithm
(80, [1 3 4 2 1])
```

A 5×5 distance matrix:

```
>>> [
>>> 	00 49 34 96 74;
>>> 	49 00 10 94 43;
>>> 	34 10 00 21 06;
>>> 	96 94 21 00 70;
>>> 	74 43 06 70 00
>>> ].heldKarpAlgorithm
(215, [1 4 3 5 2 1])
```

A 6×6 distance matrix:

```
>>> [
>>> 	00 12 29 22 13 24;
>>> 	12 00 19 03 25 06;
>>> 	29 19 00 21 23 28;
>>> 	22 03 21 00 04 05;
>>> 	13 25 23 04 00 16;
>>> 	24 06 28 05 16 00
>>> ].heldKarpAlgorithm
(76, [1 5 4 6 2 3 1])
```

Generate a uniform distribution of random points,
draw the points and the shortest tour:

~~~spl svg=A
let k = 13;
let r = Sfc32(608513);
let d = UniformDistribution([0 1]);
let p = d.randomVariate(r, [k 2]);
let m = p.distanceMatrix;
let [_, t] = m.heldKarpAlgorithm;
[
	p.PointCloud,
	Line(p @* t)
].LineDrawing
~~~

![](sw/spl/Help/Image/heldKarpAlgorithm-A.svg)

A 20×20 distance matrix:

```
>>> [
>>> 	0000 0648 2625 0549 2185
>>> 	1898 1458 1752 1963 0427
>>> 	1743 1817 1899 1060 1148
>>> 	2084 0732 1095 1725 2524
>>> 	;
>>> 	0648 0000 2363 0481 2129
>>> 	2030 1641 1594 1638 0557
>>> 	1214 1492 1710 1126 0825
>>> 	1861 0811 1195 1375 2262
>>> 	;
>>> 	2625 2362 0000 1965 0669
>>> 	1274 1541 0920 0744 2172
>>> 	1623 0875 0720 1595 3085
>>> 	0543 3113 1734 1111 0103
>>> 	;
>>> 	0549 0481 1965 0000 1667
>>> 	1605 1194 1132 1242 0431
>>> 	0963 1096 1280 0664 1249
>>> 	1464 1276 0799 0979 1866
>>> 	;
>>> 	2185 2129 0669 1667 0000
>>> 	0621 0906 0541 0643 1733
>>> 	1504 0733 0459 1187 2880
>>> 	0479 2791 1169 0932 0566
>>> 	;
>>> 	1898 2030 1274 1605 0621
>>> 	0000 0443 0662 0978 1482
>>> 	1669 0925 0839 1007 2855
>>> 	0929 2541 0843 1107 1172
>>> 	;
>>> 	1458 1641 1541 1194 0906
>>> 	0443 0000 0754 1106 1074
>>> 	1447 0976 0968 0638 2477
>>> 	1148 2132 0435 1027 1442
>>> 	;
>>> 	1752 1594 0920 1132 0541
>>> 	0662 0754 0000 0347 1293
>>> 	1015 0261 0209 0724 2319
>>> 	0389 2346 0841 0443 0818
>>> 	;
>>> 	1963 1638 0744 1242 0643
>>> 	0978 1106 0347 0000 1511
>>> 	0961 0170 0183 0970 2361
>>> 	0287 2389 1124 0388 0688
>>> 	;
>>> 	0427 0557 2172 0431 1733
>>> 	1482 1074 1293 1511 0000
>>> 	1318 1363 1447 0585 1378
>>> 	1631 1063 0641 1275 2071
>>> 	;
>>> 	1743 1214 1623 0963 1504
>>> 	1669 1447 1015 0961 1318
>>> 	0000 0813 1078 0918 1571
>>> 	1182 1882 1147 0582 1583
>>> 	;
>>> 	1817 1492 0875 1096 0733
>>> 	0925 0976 0261 0170 1363
>>> 	0813 0000 0271 0826 2215
>>> 	0373 2242 0979 0241 0774
>>> 	;
>>> 	1899 1710 0720 1280 0459
>>> 	0839 0968 0209 0183 1447
>>> 	1078 0271 0000 0882 2453
>>> 	0192 2408 1049 0504 0621
>>> 	;
>>> 	1060 1126 1595 0664 1187
>>> 	1007 0638 0724 0970 0585
>>> 	0918 0826 0882 0000 1891
>>> 	1066 1667 0251 0798 1495
>>> 	;
>>> 	1148 0825 3085 1249 2880
>>> 	2855 2477 2319 2361 1378
>>> 	1571 2215 2453 1891 0000
>>> 	2583 0559 2042 2108 2984
>>> 	;
>>> 	2084 1861 0543 1464 0479
>>> 	0929 1148 0389 0287 1631
>>> 	1182 0373 0192 1066 2583
>>> 	0000 2612 1220 0611 0442
>>> 	;
>>> 	0732 0811 3113 1276 2791
>>> 	2541 2132 2346 2389 1063
>>> 	1882 2242 2408 1667 0559
>>> 	2612 0000 1701 2125 3012
>>> 	;
>>> 	1095 1195 1734 0799 1169
>>> 	0843 0435 0841 1124 0641
>>> 	1147 0979 1049 0251 2042
>>> 	1220 1701 0000 0977 1634
>>> 	;
>>> 	1725 1375 1111 0979 0932
>>> 	1107 1027 0443 0388 1275
>>> 	0582 0241 0504 0798 2108
>>> 	0611 2125 0977 0000 1011
>>> 	;
>>> 	2524 2262 0103 1866 0566
>>> 	1172 1442 0818 0688 2071
>>> 	1583 0774 0621 1495 2984
>>> 	0442 3012 1634 1011 0000
>>> ].heldKarpAlgorithm
(
	9275,
	[
		01 17 15 02 04
		11 19 12 09 08
		13 16 03 20 05
		06 07 18 14 10
		01
	]
)
```

* * *

See also: dijkstrasAlgorithm, findShortestTour

Guides: Geometry Functions

References:
_W_
[1](https://en.wikipedia.org/wiki/Held%E2%80%93Karp_algorithm)

Further Reading: Bellman 1962, Help and Karp 1962
